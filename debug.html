<!DOCTYPE html>
<html>
<head>
    <title>Firebase Debug Test</title>
</head>
<body>
    <h1>Firebase Connection Test</h1>
    <div id="status">Testing...</div>
    
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
        import { getAuth, signInAnonymously } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js';
        import { getDatabase, ref, get } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyD66_mayYpFnps8Pe-oHpwH8g8hVFLtjTY",
            authDomain: "toiral-estimate.firebaseapp.com",
            databaseURL: "https://toiral-estimate-default-rtdb.asia-southeast1.firebasedatabase.app/",
            projectId: "toiral-estimate",
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const database = getDatabase(app);

        async function testConnection() {
            const statusEl = document.getElementById('status');
            
            try {
                statusEl.innerHTML = 'Trying anonymous auth...';
                const userCredential = await signInAnonymously(auth);
                console.log('Anonymous auth successful:', userCredential.user.uid);
                
                statusEl.innerHTML = 'Auth successful! Testing database...';
                
                const testRef = ref(database, 'test');
                const snapshot = await get(testRef);
                
                statusEl.innerHTML = 'Firebase connection successful!<br>User ID: ' + userCredential.user.uid + '<br>Database accessible: ' + snapshot.exists();
                
            } catch (error) {
                console.error('Firebase error:', error);
                statusEl.innerHTML = 'Error: ' + error.message;
            }
        }
        
        testConnection();
    </script>
</body>
</html>